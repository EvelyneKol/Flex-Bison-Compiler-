___________________BISON______________________________
%{
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void yyerror(const char *s);
int yylex(void);

char** androidIds = NULL;
int numAndroidIds = 0;


extern FILE *yyin;
extern FILE *yyout;
extern int yylex();
extern int yyparse();
extern int yylineno;
extern char *yytext;
extern int yylval;
extern int lines;
extern int id_line;
extern int currentLayoutType;
extern int RadioButtonCount1;
extern int RadioButtonCount2;
extern int radioGroupExtra;
extern int progress;
extern int max_value;

%}


%token android_id
%token android_layout_width
%token android_layout_height
%token android_orientation
%token android_text
%token android_textcolor
%token android_src
%token android_padding
%token android_max
%token android_progress
%token android_radio_group_extra
%token android_checkedButton

%token LINEAR_LAYOUT_START
%token LINEAR_LAYOUT_STOP
%token RELATIVE_LAYOUT_START
%token RELATIVE_LAYOUT_STOP
%token TEXT_VIEW_START
%token TEXT_VIEW_STOP
%token CLOSE_TEXT_VIEW
%token IMAGE_VIEW_START
%token IMAGE_VIEW_STOP
%token BUTTON_START
%token BUTTON_STOP
%token RADIO_GROUP_START
%token RADIO_GROUP_STOP
%token RADIO_BUTTON_START
%token RADIO_BUTTON_STOP
%token PROGRESS_BAR_START
%token PROGRESS_BAR_STOP
%token CLOSE_LWAGGER
%token NL
%token STRING
%token VALUE
%token INTEGER FLOAT 
%token TRUE FALSE
%token STR
%token LWAGGER
%token INT

%%

layout: LINEAR_LAYOUT_START EOL attributes7  LWAGGER EOL content EOL LINEAR_LAYOUT_STOP  {printf("\n\nCode parsed successfully\n");}
																						   { printf("Number of RadioButtons: %d\n", RadioButtonCount1); }
                                                                                       {  if ( radioGroupExtra != RadioButtonCount1) {
																					   printf("\n android:radio_group_extra does not match RadioButtonCount1\n");
                                                        } else {
                                                               printf("\n android:radio_group_extra matches RadioButtonCount1\n");
                                                        
                                                        
                                                        }}
       | RELATIVE_LAYOUT_START EOL attributes8 LWAGGER EOL content EOL RELATIVE_LAYOUT_STOP{printf("\n\nCode parsed successfully(RelativeLayout)\n");}
                                                                                            { printf("Number of RadioButtons: %d\n", RadioButtonCount2); }
                                                                                            {  if ( radioGroupExtra != RadioButtonCount2) {
                                                               printf("\n android:radio_group_extra does not match RadioButtonCount2\n");
                                                        } else {
                                                               printf("\n android:radio_group_extra matches RadioButtonCount2\n");
                                                        
                                                        
                                                        }} 
      ;



content: /* empty */ 
       | element 
       | element EOL content
       ;

element: text_view
       | image_view
       | button
       | radio_group
       | progress_bar
       | layout
       ;

content2: /* empty */ 
       | element2 
       | element2 EOL content2  
       ;

element2: text_view
       | image_view
       | button
       | radio_group
       | progress_bar
       | radio_button
       | layout
       ;

text_view: TEXT_VIEW_START EOL attributes1 CLOSE_LWAGGER EOL 
         ;

image_view: IMAGE_VIEW_START EOL attributes2 CLOSE_LWAGGER EOL
          ;

button: BUTTON_START attributes3 BUTTON_STOP
       ;

radio_group: RADIO_GROUP_START EOL attributes4 LWAGGER EOL content2 EOL RADIO_GROUP_STOP
            ;

radio_button: RADIO_BUTTON_START EOL attributes5 CLOSE_LWAGGER  EOL
         {
                 if (currentLayoutType == 1)
                     RadioButtonCount1++;
                 else if (currentLayoutType == 2)
                     RadioButtonCount2++;
             }
         ;

progress_bar: PROGRESS_BAR_START EOL attributes6 {if (progress>=max_value || progress<0) {printf ("\nError android:progress is not between 0 and the value of android:max!"); YYABORT;} ;}CLOSE_LWAGGER EOL


attributes1:  /* empty */ 
          | attribute1
          | attribute1 EOL attributes1
          ;

attributes2:  /* empty */ 
          | attribute2 
          | attribute2 EOL attributes2
          ;

attributes3:  /* empty */ 
          | attribute3 
          | attribute3 EOL attributes3
          ;

attributes4:  /* empty */ 
          | attribute4 
          | attribute4 EOL attributes4
          ;

attributes5:  /* empty */ 
          | attribute5 
          | attribute5 EOL attributes5
          ;

attributes6:  /* empty */ 
          | attribute6 
          | attribute6 EOL attributes6
          ;

attributes7:  /* empty */ 
          | attribute7 
          | attribute7 EOL attributes7
          ;

attributes8:  /* empty */ 
          | attribute8 
          | attribute8 EOL attributes8
          ;


attribute1: android_id STR
{
            // Check for uniqueness
            for (int i = 0; i < numAndroidIds; i++) {
                if (strcmp(yytext, androidIds[i]) == 0) {
                    printf("Error: Duplicate android:id value '%s' at line %d\n", yytext, yylineno);
                    exit(EXIT_FAILURE);
                }
            }

            // Store the encountered android:id value
            androidIds = realloc(androidIds, (numAndroidIds + 1) * sizeof(char*));
            androidIds[numAndroidIds] = strdup(yytext);
            numAndroidIds++;
         }
         | android_text STR
         | android_textcolor STR
         | android_layout_width STR
         | android_layout_width INTEGER
         | android_layout_height STR
         | android_layout_height INTEGER
         | android_orientation STR
         ;

attribute2: android_src STR
         | android_id STR
         {
            // Check for uniqueness
            for (int i = 0; i < numAndroidIds; i++) {
                if (strcmp(yytext, androidIds[i]) == 0) {
                    printf("Error: Duplicate android:id value '%s' at line %d\n", yytext, yylineno);
                    exit(EXIT_FAILURE);
                }
            }

            // Store the encountered android:id value
            androidIds = realloc(androidIds, (numAndroidIds + 1) * sizeof(char*));
            androidIds[numAndroidIds] = strdup(yytext);
            numAndroidIds++;
         }
         | android_padding INTEGER
         | android_padding STR
         | android_layout_width STR
         | android_layout_width INTEGER
         | android_layout_height STR
         | android_layout_height INTEGER
         | android_orientation STR
         ;

attribute3: android_text STR
         | android_id STR
         {
            // Check for uniqueness
            for (int i = 0; i < numAndroidIds; i++) {
                if (strcmp(yytext, androidIds[i]) == 0) {
                    printf("Error: Duplicate android:id value '%s' at line %d\n", yytext, yylineno);
                    exit(EXIT_FAILURE);
                }
            }

            // Store the encountered android:id value
            androidIds = realloc(androidIds, (numAndroidIds + 1) * sizeof(char*));
            androidIds[numAndroidIds] = strdup(yytext);
            numAndroidIds++;
         }
         | android_padding INTEGER
         | android_padding STR
         | android_layout_width STR
         | android_layout_width INTEGER
         | android_layout_height STR
         | android_layout_height INTEGER
         | android_orientation STR
         ;

attribute4: android_text STR
         | android_id STR
         {
            // Check for uniqueness
            for (int i = 0; i < numAndroidIds; i++) {
                if (strcmp(yytext, androidIds[i]) == 0) {
                    printf("Error: Duplicate android:id value '%s' at line %d\n", yytext, yylineno);
                    exit(EXIT_FAILURE);
                }
            }

            // Store the encountered android:id value
            androidIds = realloc(androidIds, (numAndroidIds + 1) * sizeof(char*));
            androidIds[numAndroidIds] = strdup(yytext);
            numAndroidIds++;
         }
         | android_layout_width STR
         | android_layout_width INTEGER
         | android_layout_height STR
         | android_layout_height INTEGER
         | android_orientation STR
         | android_radio_group_extra INTEGER
         ;

attribute5: android_text STR
         | android_id STR
         {
            // Check for uniqueness
            for (int i = 0; i < numAndroidIds; i++) {
                if (strcmp(yytext, androidIds[i]) == 0) {
                    printf("Error: Duplicate android:id value '%s' at line %d\n", yytext, yylineno);
                    exit(EXIT_FAILURE);
                }
            }

            // Store the encountered android:id value
            androidIds = realloc(androidIds, (numAndroidIds + 1) * sizeof(char*));
            androidIds[numAndroidIds] = strdup(yytext);
            numAndroidIds++;
         }
         | android_layout_width STR
         | android_layout_width INTEGER
         | android_layout_height STR
         | android_layout_height INTEGER
         | android_orientation STR
         ;

attribute6: android_id STR
{
            // Check for uniqueness
            for (int i = 0; i < numAndroidIds; i++) {
                if (strcmp(yytext, androidIds[i]) == 0) {
                    printf("Error: Duplicate android:id value '%s' at line %d\n", yytext, yylineno);
                    exit(EXIT_FAILURE);
                }
            }

            // Store the encountered android:id value
            androidIds = realloc(androidIds, (numAndroidIds + 1) * sizeof(char*));
            androidIds[numAndroidIds] = strdup(yytext);
            numAndroidIds++;
         }
         | android_progress INTEGER
         | android_max INTEGER
         | android_layout_width STR
         | android_layout_width INTEGER
         | android_layout_height STR
         | android_layout_height INTEGER
         | android_orientation STR
         ;

attribute7: android_id STR
{
            // Check for uniqueness
            for (int i = 0; i < numAndroidIds; i++) {
                if (strcmp(yytext, androidIds[i]) == 0) {
                    printf("Error: Duplicate android:id value '%s' at line %d\n", yytext, yylineno);
                    exit(EXIT_FAILURE);
                }
            }

            // Store the encountered android:id value
            androidIds = realloc(androidIds, (numAndroidIds + 1) * sizeof(char*));
            androidIds[numAndroidIds] = strdup(yytext);
            numAndroidIds++;
         }
          | android_orientation STR
         | android_layout_width STR
         | android_layout_width INTEGER
         | android_layout_height STR
         | android_layout_height INTEGER
         ;


  attribute8: android_id STR
  {
            // Check for uniqueness
            for (int i = 0; i < numAndroidIds; i++) {
                if (strcmp(yytext, androidIds[i]) == 0) {
                    printf("Error: Duplicate android:id value '%s' at line %d\n", yytext, yylineno);
                    exit(EXIT_FAILURE);
                }
            }

            // Store the encountered android:id value
            androidIds = realloc(androidIds, (numAndroidIds + 1) * sizeof(char*));
            androidIds[numAndroidIds] = strdup(yytext);
            numAndroidIds++;
         }
         | android_layout_width STR
         | android_layout_width INTEGER
         | android_layout_height STR
         | android_layout_height INTEGER
         
         ;       

       



EOL: /* nothing */
   | NL EOL
   ; 


%%

void yyerror(const char *s)
{
	printf("\n\nerror: %s\n ", s);
	printf("\n");
        printf("Line %d: %s\n", yylineno, yytext);
}


int main(int argc, char **argv)
{
	++argv; --argc;
	
	if(argc > 0)
		yyin = fopen(argv[0], "r");
	else
		yyin = stdin;
		
	yyout = stdout;
	
	yyparse();

    for (int i = 0; i < numAndroidIds; i++) {
        free(androidIds[i]);
    }
    free(androidIds);
    
	return 0;
}

___________________FLEX________________

%option yylineno
%{
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "bison.tab.h"
void token_print(int token_id);

int lines = 0;
int id_line = 0;
int currentLayoutType = 0;
int RadioButtonCount1 = 0;
int RadioButtonCount2 = 0;
int radioGroupExtra = 0;
int progress = 0;
int max_value = 0;
%}


digit		[0-9]
integer		{digit}+
float		{digit}*\.{digit}+
letter		[a-zA-z0-9_ ]*
word		{letter}+
propertyC	{word}[.]{word}

%%
\"[0-9]+\"        				{printf("%s", yytext); yylval = atoi(yytext+1); return INT;}
"<LinearLayout"                 {token_print(LINEAR_LAYOUT_START); return LINEAR_LAYOUT_START; }
"</LinearLayout>"               {token_print(LINEAR_LAYOUT_STOP); return LINEAR_LAYOUT_STOP; }
"<RelativeLayout"               {token_print(RELATIVE_LAYOUT_START); return RELATIVE_LAYOUT_START; }
"</RelativeLayout>"             {token_print(RELATIVE_LAYOUT_STOP); return RELATIVE_LAYOUT_STOP; }
"<TextView"                     {token_print(TEXT_VIEW_START); return TEXT_VIEW_START; }
"</TextView>"                   {token_print(TEXT_VIEW_STOP); return TEXT_VIEW_STOP; }
"<ImageView"                    {token_print(IMAGE_VIEW_START); return IMAGE_VIEW_START; }
"</ImageView>"                  {token_print(IMAGE_VIEW_STOP); return IMAGE_VIEW_STOP; }
"<Button"                       {token_print(BUTTON_START); return BUTTON_START; }
"</Button>"                     {token_print(BUTTON_STOP); return BUTTON_STOP; }
"<RadioGroup"                   {token_print(RADIO_GROUP_START); return RADIO_GROUP_START; }
"</RadioGroup>"                 {token_print(RADIO_GROUP_STOP); return RADIO_GROUP_STOP; }
"<RadioButton"                  {token_print(RADIO_BUTTON_START); return RADIO_BUTTON_START; }
"</RadioButton>"                {token_print(RADIO_BUTTON_STOP); return RADIO_BUTTON_STOP; }
"<ProgressBar"                  {token_print(PROGRESS_BAR_START); return PROGRESS_BAR_START; }
"</ProgressBar>"                {token_print(PROGRESS_BAR_STOP); return PROGRESS_BAR_STOP; }
"android:id="                   {token_print(android_id); return android_id; }
"android:layout_width="         {token_print(android_layout_width);return android_layout_width; }
"android:layout_height="        {token_print(android_layout_height); return android_layout_height; }
"android:orientation="          {token_print(android_orientation); return android_orientation; }
"android:text="                 {token_print(android_text); return android_text; }
"android:textColor="            {token_print(android_textcolor); return android_textcolor; }
"android:src="                  {token_print(android_src); return android_src; }
"android:padding="              {token_print(android_padding); return android_padding; }
"android:max="                  {token_print(android_max); return android_max; }
"android:progress="             {token_print(android_progress); return android_progress; }
"android:checkedButton="        {token_print(android_checkedButton); return android_checkedButton; }
"android:radio_group_extra"     {token_print(android_radio_group_extra); return android_radio_group_extra; }
["]{word}["]				    {printf("%s", yytext); return STR;}
">"                             {token_print(LWAGGER); return LWAGGER;}
"/>"                            {token_print(CLOSE_LWAGGER); return CLOSE_LWAGGER;}
["]{integer}["]					{printf("%s", yytext); yylval = atoi(yytext); return INTEGER;}
{float}						    {printf("%s", yytext); return FLOAT;}
true 						    {printf("%s", yytext); return TRUE;}
false						    {printf("%s", yytext); return FALSE;}
[\n]+                           {printf("\n"); lines++; return NL;}  
"<!--"([^<]|"<"[^!])*"-->"   /* Ignore comments */
[\r]+?                          { printf("%s" ,yytext); /*Ignore carriage returns*/}
[ \t]+                          { printf("%s" ,yytext); /*Ignore spaces and tabs*/}
.                               { printf("Invalid token: %s\n", yytext); }

%%

void token_print(int token_id) {
    printf("%s", yytext);
}
